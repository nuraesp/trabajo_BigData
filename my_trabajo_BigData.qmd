---
title: "La evoluci√≥n del aborto en las √∫ltimas d√©cadas"
 
description: "An√°lisis descriptivo y exploratorio del aborto en Espa√±a utilizando datos estad√≠sticos oficiales"

author: 
  - Rayan Akhnati Tafar
  - Noura Es Salhi Piquer
  - Giulia Piovesan
date: today
categories: [trabajo BigData, aborto]

title-block-banner: "imagenes/abortion.jpg"
title-block-banner-color: "#E57373"    
title-block-banner-text-color: "#000000"      
 


format: 
  html:
    theme: flatly                    
    embed-resources: true
    link-external-newwindow: true
    toc: true
    toc-location: left
    toc-depth: 3
    smooth-scroll: true
    code-tools: true
    code-fold: true
    code-summary: "Mostrar / ocultar c√≥digo"
                  

---

::: callout-note
Prohibir y criminalizar el aborto no acaba con su pr√°ctica, sino que lo convierte en un acto clandestino, peligroso e inseguro para las mujeres. üò•ü•∫üëø
:::


# Introducci√≥n

El aborto es la interrupci√≥n voluntaria o involuntaria del embarazo, y plantea cuestiones desde los derechos reproductivos de las mujeres hasta consideraciones morales y religiosas. A lo largo del tiempo su regulaci√≥n ha variado de manera significativa en los pa√≠ses.

En el a√±o 1985 en Espana, bajo la Ley Org√°nica 9/1985,de 5 de julio,conocida como la Ley de supuestos,que despenaliza la interrupci√≥n voluntaria del embarazo(IVE) bajo 3 circunstancias espec√≠ficas:violacion (hasta 12 semanas),grave riesgo para la salud fisica o psiquica de la madre (sin limite),y graves taras fisicas o psiquicas del feto (hasta 22 semanas) ,siendo un hito que permiti√≥ el acceso al aborto legal en centros acreditados por primera vez,aunque aun dentro de un marco penal.

Posteriormente la Ley Organica 2/2010 sustituy√≥ a Ley Org√°nica 9/1985. Hasta dia de hoy el aborto esta regulado por la Ley Org√°nica 2/2010 que establece un marco legal para garantizar el derecho de las mujeres y ni√±as que puedan quedarse embarazadas. Esta normativa permite la interrupci√≥n voluntaria del embarazo hasta la semana 14 sin necesidad de justificaci√≥n, y hasta la semana 22 en casos de riesgo grave para la vida de la persona gestante.

La mayor parte de Europa ha aprobado leyes que protegen y despenalizan el aborto aunque siguen existiendo algunas barreras como los periodos de espera o el asesoramiento obligatorio que dificultan su pr√°ctica y desarrollo. En microestados como Andorra y Malta, con una presencia de la iglesia cat√≥lica muy importante en la vida pol√≠tica y gubernamental, sigue siendo ilegal.

# Bases de Datos

Las bases de datos utilizadas han sido la OSF, WHO y Eurostat

```{r}

#| echo: false
#| message: false
#| warning: false

my_osf <- "./imagenes/flagosf.png"
my_euro <- "./imagenes/flageuro.png"
my_who <- "./imagenes/flagwho.png"

```

:::::: columns
::: {.column width="33%"}
![](./imagenes/flagosf.png){width="100%"}
:::

::: {.column width="33%"}
![](./imagenes/flageuro.png){width="100%"}
:::

::: {.column width="33%"}
![](./imagenes/flagwho.png){width="100%"}
:::
::::::

# Librer√≠as

```{r}
#| echo: true
#| message: false
#| warning: false

library(eurostat)
library(tidyverse)
library(sf)
library(magrittr)
library(dplyr)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(eurostat)
library(sf)
library(gt)
library(gtExtras)
library(rio)
library(readr)
library(forcats)
library(giscoR)
library(plotly)
library(magrittr)
```

# √Åmbito geogr√°fico del aborto 

## Evoluci√≥n de los abortos en el Mundo

El gr√°fico representa la cantidad total de abortos (n√∫mero absoluto de procedimientos) por regi√≥n del mundo entre 1990 y 2017. La escala vertical es logar√≠tmica, lo que permite comparar de manera visual la evoluci√≥n proporcional de las cifras entre regiones con vol√∫menes muy distintos, sin que las regiones con n√∫meros m√°s altos dominen la gr√°fica. Al hacer la interpretacion por regiones podemos observar: 

1. Asia
Es la regi√≥n con el mayor volumen absoluto de abortos durante todo el per√≠odo (esto se infiere porque su l√≠nea est√° sistem√°ticamente por encima del resto en escala logar√≠tmica). Muestra una tendencia a la baja continua desde 1990, especialmente marcada entre 1990 y 2000.Esta reducci√≥n puede estar relacionada con pol√≠ticas de planificaci√≥n familiar.

2. Europa y Am√©rica del Norte
Presenta un aumento hasta mediados de los 90, seguido de una reducci√≥n sostenida hasta estabilizarse a partir de 2010. El pico y posterior descenso pueden reflejar cambios legislativos, mayor acceso a anticoncepci√≥n de emergencia o evoluci√≥n en los comportamientos reproductivos.

3. Am√©rica Latina
Con una tendencia estable hasta 2000 y un incremento moderado pero claro a partir de ese a√±o.El aumento puede deberse a mejoras en el reporte, liberalizaci√≥n legal en algunos pa√≠ses, o persistencia de altas necesidades insatisfechas de anticoncepci√≥n.

4. √Åfrica Subsahariana
Muestra la tendencia decreciente m√°s pronunciada en t√©rminos proporcionales desde 1990. Aunque part√≠a de un volumen considerable, la reducci√≥n continua sugiere avances en acceso a m√©todos anticonceptivos, educaci√≥n sexual o cambios demogr√°ficos.

5. Asia Occidental y Norte de √Åfrica
Ligero aumento hacia el a√±o 2000 y luego estabilizaci√≥n o leve descenso. La tendencia es la menos marcada entre todas las regiones.

6. Ocean√≠a
Volumen m√°s bajo de todas las regiones durante todo el per√≠odo con una tendencia plana y estable, con muy poca variaci√≥n.

El descenso general puede relacionarse con:
- Mejora en el acceso a anticoncepci√≥n moderna.
- Educaci√≥n sexual.
- Cambios en la estructura por edad de la poblaci√≥n.
- Legislaciones m√°s restrictivas o, por el contrario, m√°s preventivas.

El caso de Am√©rica Latina destaca como regi√≥n donde el n√∫mero total ha crecido, posiblemente por la legalizaci√≥n parcial en algunos pa√≠ses que hace visible una pr√°ctica antes oculta.

```{r}
#| echo: true
#| message: false
#| warning: false

ruta_global_abort_ind <- "./datasets/Global Abortion Incidence Dataset (1).csv"
global_abortion <- rio::import(ruta_global_abort_ind)

global_abort_mundial <- global_abortion %>% 
  select(yearstart, numberofabortions, region) %>%
  filter(!is.na(numberofabortions)) 


global_abort_mundial <- global_abort_mundial %>%
  mutate(region = case_when(
    region %in% c("Australia and New Zealand", "Oceania (excluding Australia and New Zealand)") ~ "Ocean√≠a",
    region %in% c("Central and Southern Asia", "East and Southeastern Asia") ~ "Asia",
    TRUE ~ region
  ))

abort_region_mundial <- global_abort_mundial %>% 
  group_by(region, yearstart) %>% 
  summarise(numberofabortions = sum(numberofabortions, na.rm = TRUE))




p3 <- ggplot() +
  geom_line(data = abort_region_mundial, aes(yearstart, numberofabortions, group = region, color= region))+
  labs(
    title = "Abortos en el mundo entre 1990 y 2017", 
    x = "A√±o",
    y= "Abortos") +
  theme_minimal()

p4 <- p3 + scale_y_continuous(breaks = c(0, 100000, 1000000, 10000000), labels = scales::comma)

p4 <- p3 +
  scale_y_log10(
    labels = scales::comma)

ggplotly(p4, width = 600, height = 400)

```


## Evoluci√≥n de los abortos en Europa

El gr√°fico muestra la evoluci√≥n del n√∫mero de abortos en distintos pa√≠ses europeos entre 1990 y 2017. En la parte superior del gr√°fico aparecen, para cada a√±o, los pa√≠ses con mayor n√∫mero de abortos, mientras que en la parte inferior se representan aquellos con las cifras m√°s bajas. Adem√°s, se incluye la evoluci√≥n de Espa√±a y de Italia.

En los primeros a√±os del periodo analizado, Bielorrusia se sit√∫a como el pa√≠s con mayor n√∫mero de abortos, superando los 200.000 anuales. Sin embargo, a partir de finales de los a√±os noventa, Francia y el Reino Unido pasan a ocupar de forma recurrente las primeras posiciones. Francia mantiene durante todo el periodo cifras muy elevadas y bastante estables, en torno a los 190.000‚Äì210.000 abortos anuales, mientras que el Reino Unido presenta valores similares, sin grandes oscilaciones. Esto puede explicarse, en parte, por su mayor tama√±o poblacional y por la existencia de sistemas de registro consolidados.

En el extremo inferior del gr√°fico se sit√∫an pa√≠ses como Islandia, Malta, Montenegro, Finlandia y Polonia. Estos pa√≠ses registran un n√∫mero muy reducido de abortos, en muchos casos de solo unos pocos miles o incluso cifras cercanas a cero. En algunos casos, como Polonia, estas cifras tan bajas est√°n relacionadas con una legislaci√≥n muy restrictiva en materia de interrupci√≥n voluntaria del embarazo, mientras que en otros, como Islandia o Malta, el reducido tama√±o de la poblaci√≥n es un factor determinante.

En cuanto a Espa√±a, se observa una clara tendencia creciente desde 1990 hasta aproximadamente 2010‚Äì2011. Durante este periodo, el n√∫mero de abortos aumenta desde unos 40.000 hasta alcanzar un m√°ximo cercano a los 120.000. A partir de ese momento, se produce un ligero descenso y una posterior estabilizaci√≥n en torno a los 95.000‚Äì100.000 abortos anuales. Esta evoluci√≥n puede estar asociada a cambios legislativos, a una mayor difusi√≥n de m√©todos anticonceptivos y a transformaciones demogr√°ficas.

Por su parte, Italia presenta una tendencia descendente pr√°cticamente continua a lo largo de todo el periodo analizado. Parte de cifras relativamente altas a comienzos de los a√±os noventa, alrededor de 160.000 abortos, y desciende progresivamente hasta situarse por debajo de los 90.000 en 2017. Italia destaca, por tanto, como un ejemplo de reducci√≥n sostenida del n√∫mero de abortos a lo largo del tiempo.

Comparando ambos pa√≠ses, se observa que Italia presenta cifras superiores a las de Espa√±a durante la mayor parte del periodo. No obstante, en torno a los a√±os 2008‚Äì2011, las cifras tienden a converger y, en los √∫ltimos a√±os, Espa√±a llega incluso a superar ligeramente a Italia.

En conclusi√≥n, el gr√°fico pone de manifiesto la coexistencia de tres patrones claros: pa√≠ses con cifras altas y estables (como Francia y el Reino Unido), pa√≠ses con cifras muy bajas (como Polonia o Islandia) y pa√≠ses con evoluciones diferenciadas, como Espa√±a ‚Äîcon una fase de crecimiento seguida de estabilizaci√≥n‚Äî e Italia, con una disminuci√≥n progresiva a lo largo del tiempo.
```{r}
#| echo: true
#| message: false
#| warning: false



global_abort_europa <- global_abortion %>% 
  select(country, yearstart, numberofabortions, region) %>%
  filter(region == "Europe and Northern America") %>% 
  filter(!(country %in% c("Canada", "Ukraine", "United States of America", 
                        "Russian Federation", "Romania"))) %>% 
  filter(!is.na(numberofabortions)) 



p1 <- ggplot() +
  geom_line(data = global_abort_europa %>% group_by(yearstart) %>% slice_max(numberofabortions),
            aes(yearstart, numberofabortions), color = "black") +
  geom_line(data = global_abort_europa %>% group_by(yearstart) %>% slice_min(numberofabortions),
            aes(yearstart, numberofabortions), color = "black") +
  geom_line(data = global_abort_europa%>% filter(country %in% c("Spain", "Italy")),
            aes(x = yearstart, y = numberofabortions, color = country)) +
  labs(
    title = "Abortos en Europa entre 1990 y 2017", 
    x = "A√±o",
    y= "Abortos") +
  theme_minimal()


p2 <- p1 + 
  geom_label(data = global_abort_europa %>% group_by(yearstart) %>% slice_max(numberofabortions) %>%
      filter(yearstart == max(yearstart)), aes(yearstart, numberofabortions, label = country),
      show.legend = FALSE, size = 3) +
  geom_label(data = global_abort_europa %>% group_by(yearstart) %>% slice_min(numberofabortions) %>%
      filter(yearstart == max(yearstart)), aes(yearstart, numberofabortions, label = country),
      show.legend = FALSE, size = 3)

p2
```


# Evoluci√≥n del aborto en Espa√±a

## Abortos legalmente inducidos en Espa√±a entre 1985 y 2010 


El gr√°fico representa la evoluci√≥n del n√∫mero de abortos en Espa√±a entre 1985 y 2010. A lo largo de todo el periodo se observa una tendencia general claramente ascendente, aunque con algunas variaciones seg√∫n los a√±os.

En los primeros a√±os, desde 1985 hasta finales de la d√©cada de los ochenta, el n√∫mero de abortos es relativamente bajo, pero aumenta de forma r√°pida. Este crecimiento inicial coincide con la despenalizaci√≥n del aborto en determinados supuestos y con una progresiva normalizaci√≥n y registro de estas intervenciones.

Durante la d√©cada de los noventa, el n√∫mero de abortos contin√∫a aumentando, aunque de manera m√°s moderada. En este periodo se aprecia cierta estabilidad, con peque√±as fluctuaciones, situ√°ndose en torno a los 45.000‚Äì50.000 abortos anuales.

A partir de finales de los a√±os noventa y comienzos de los 2000, se produce un incremento m√°s acusado y sostenido. El n√∫mero de abortos crece de forma continua hasta alcanzar su punto m√°ximo alrededor de 2007‚Äì2008, superando los 110.000 casos. Este aumento puede relacionarse con cambios sociales, demogr√°ficos y en el comportamiento reproductivo de la poblaci√≥n.

Finalmente, en los √∫ltimos a√±os del periodo analizado, entre 2008 y 2010, el crecimiento se frena y se observan ligeras oscilaciones, manteni√©ndose el n√∫mero de abortos en valores elevados.


```{r}
#| echo: true
#| message: false
#| warning: false
my_table <- "demo_fabort" 
df <- get_eurostat(my_table, time_format = 'raw', keepFlags = TRUE)
df_names <- names(df)
df <- label_eurostat(df, code = df_names, fix_duplicated = TRUE)
rm(df_names, my_table)

dist_geo <- df %>%
  distinct(geo)

count_geo <- df %>% 
  count(geo == "Spain")

df <- df %>% 
  mutate(TIME_PERIOD = as.numeric(TIME_PERIOD)) %>% 
  filter(TIME_PERIOD >= 1985)

df_spain_85_10 <- df %>%
  filter(
    geo == "Spain",
    between(TIME_PERIOD, 1985, 2010)
  ) 

aa<- df_spain_85_10 %>% filter(age == "Total")

aa<- df_spain_85_10 %>% filter(age == "Total")

g1 <- ggplot(aa,aes(x=TIME_PERIOD, y=values))+
  geom_line(color="plum",linewidth=1) + 
  geom_point(color="navyblue",size= 3)+
  labs(title = "Evoluci√≥n del aborto en Espa√±a  desde 1985 y 2010",
       x="A√±os",
       y="Abortos"
  )
ggplotly(g1, width = 600, height = 400)
```

## Abortos despu√©s de introducirse la Ley de salud sexual y resporoductiva entre 2010 y 2023 

El gr√°fico muestra la evoluci√≥n del n√∫mero de abortos en Espa√±a entre 2010 y 2023 y refleja una trayectoria marcada por descensos, cambios de tendencia y un repunte final, que puede explicarse a partir del contexto legal, econ√≥mico y social del periodo.

En los primeros a√±os, entre 2010 y 2013, el n√∫mero de abortos se sit√∫a en niveles elevados, ligeramente por encima de los 110.000, pero inicia ya una tendencia descendente. Esta bajada puede relacionarse con varios factores concurrentes: la entrada en vigor de la **Ley de Salud Sexual y Reproductiva de 2010**, que reforz√≥ la educaci√≥n sexual y el acceso a m√©todos anticonceptivos, y el efecto todav√≠a presente de pol√≠ticas de apoyo a la natalidad como el **cheque beb√©**, vigente hasta 2010, que pudo favorecer la continuaci√≥n de algunos embarazos en un contexto de crisis econ√≥mica.

Entre 2013 y 2015 el descenso se intensifica y el n√∫mero de abortos cae de forma notable, situ√°ndose en torno a los 94.000. Este periodo coincide con cambios demogr√°ficos importantes ‚Äîreducci√≥n de la poblaci√≥n joven y retraso de la maternidad‚Äî y con una mayor generalizaci√≥n de m√©todos anticonceptivos eficaces, lo que contribuye a la disminuci√≥n de embarazos no deseados.

A partir de 2015 y hasta 2019 se observa un ligero cambio de tendencia, con un aumento moderado y progresivo de los abortos, que vuelven a acercarse a los 100.000 casos. Esta recuperaci√≥n sugiere una estabilizaci√≥n tras varios a√±os de descenso, en un contexto social y econ√≥mico algo m√°s favorable.

En 2020 se produce una ca√≠da muy acusada, alcanz√°ndose el valor m√≠nimo de todo el periodo. Este descenso excepcional se explica fundamentalmente por el impacto de la **pandemia de la COVID-19**, que limit√≥ la movilidad, dificult√≥ el acceso a los servicios sanitarios y alter√≥ el registro de intervenciones m√©dicas.

Desde 2021 hasta 2023 el gr√°fico muestra un repunte claro y sostenido. El n√∫mero de abortos aumenta a√±o tras a√±o y supera de nuevo los 100.000, aunque sin alcanzar los m√°ximos de comienzos de la d√©cada. Este crecimiento indica una recuperaci√≥n tras el impacto puntual de la pandemia.

En conclusi√≥n, la gr√°fica evidencia que entre 2010 y 2023 el n√∫mero de abortos en Espa√±a no sigue una tendencia lineal, sino que est√° condicionado por **factores legales, preventivos, econ√≥micos, demogr√°ficos y excepcionales**, destacando el papel de la Ley de 2010 en la prevenci√≥n, el efecto coyuntural de la pandemia y la posterior recuperaci√≥n en los √∫ltimos a√±os del periodo analizado.


```{r}
#| echo: true
#| message: false
#| warning: false
df_spain_2010 <- df %>%
  filter(geo=="Spain",TIME_PERIOD>=2010)

#grafica
bb <-df_spain_2010 %>% filter(age == "Total") 

g2 <- ggplot(bb,aes(x=TIME_PERIOD, y=values))+
  geom_line(color="plum",linewidth=1) + 
  geom_point(color="navyblue",size= 2)+
  labs(title = "Evoluci√≥n del aborto en Espa√±a desde 2010 hasta 2023",
       x="A√±os",
       y="Abortos"
  )

ggplotly(g2, width = 600, height = 400)
```

## Tasas de aborto en las Comunidades Aut√≥nomas

El objetivo de este resumen es mostrar la dispersi√≥n de las **cifras anuales de abortos** en el territorio espa√±ol, comparando la Comunidad con el **mayor n√∫mero de abortos** frente a la que registr√≥ el **menor n√∫mero**, y ofreciendo una **media** para contextualizar el dato.

```{r}
#| echo: true
#| message: false
#| warning: false
df_spain_85_23 <- df %>%
  filter(
    geo == "Spain",
    between(TIME_PERIOD, 1985, 2023)
  )

df_summary <- df_spain_85_23 %>%
  group_by(TIME_PERIOD) %>%
  summarise(
    max_ev = max(values, na.rm = TRUE),   
    mean_ev = mean(values, na.rm = TRUE), 
    min_ev = min(values, na.rm = TRUE),   
    .groups = 'drop'
  )

tabla_gt1 <- df_summary %>%
  gt() %>%
  tab_header(
    title = "Resumen de Abortos en Espa√±a (1985-2023)"
  ) %>%
  cols_label(
    TIME_PERIOD = "A√±o",
    min_ev = "N.¬∫Abortos M√≠nimo",
    mean_ev = "N.¬∫Abortos Medio",
    max_ev = "N.¬∫Abortos M√°ximo"
  ) %>%
  data_color(
    columns = c(max_ev, min_ev),  
    colors = scales::col_numeric(
      palette = c("gray", "plum"),
      domain = NULL
    )
  ) 

DT::datatable(df_summary)
```

## Aborto en las Comunidades Aut√≥nomas

Esta tabla resume las cinco Comunidades Aut√≥nomas (CC.AA.) que registraron la **tasa de Interrupci√≥n Voluntaria del Embarazo (IVE) m√°s alta** en Espa√±a en el a√±o 2024.

La m√©trica utilizada es la **Tasa de Abortos por cada 1.000 mujeres en edad f√©rtil (15-44 a√±os)**, lo que permite una comparaci√≥n estandarizada y directa entre regiones, independientemente del tama√±o de su poblaci√≥n.

**Diferencia Respecto a la Media Nacional:** Para ponerlo en contexto, la media nacional de abortos en 2024 se sit√∫a aproximadamente en **12,36 por cada 1.000 mujeres**. Las cinco Comunidades mostradas en esta tabla **superan todas la media espa√±ola**, indicando una mayor prevalencia de la IVE en estas regiones. 


**Las 5 CCAA con *mayores Tasas* de Aborto**

Al igual que en las tasas m√°s altas, esta m√©trica se expresa como el n√∫mero de IVE por cada **1.000 mujeres en edad f√©rtil (15-44 a√±os)**, permitiendo una comparaci√≥n directa de la incidencia real.

Esta tabla muestra las cinco Comunidades Aut√≥nomas con la mayor tasa de Interrupci√≥n Voluntaria del Embarazo (IVE) en 2024. La tasa se calcula por cada 1.000 mujeres en edad f√©rtil (15-44 a√±os). Catalu√±a lidera la clasificaci√≥n con una tasa de 14,89, lo que significa que casi 15 de cada 1.000 mujeres en edad f√©rtil en esa Comunidad tuvieron un aborto ese a√±o.

```{r}
#| echo: true
#| message: false
#| warning: false
ruta_ccaa <- "./datasets/abortos_pccaa.csv"
datos_aborto_pccaa <- rio::import(ruta_ccaa)

datos_aborto_limpio <- datos_aborto_pccaa %>%
  rename_with(
      .fn = ~str_remove(., "X"), 
      .cols = starts_with("X20") 
    )
datos_aborto_limpio <- import(
  "./datasets/abortos_pccaa.csv", 
  setclass = "tibble",
  header = TRUE
)
datos_long <- datos_aborto_limpio %>%
    pivot_longer(
      cols = c(`2015`:`2024`), 
      names_to = "Year",         
      values_to = "Tasa"         
    )
datos_long$Year <- as.integer(datos_long$Year)
datos_long <- datos_long %>%
    mutate(Year = as.integer(Year))
datos_long <- datos_long %>%
  mutate(Tasa = trimws(Tasa))  
datos_long <- datos_long %>%
  mutate(Tasa = str_replace(Tasa, ",", "."))
datos_long <- datos_long %>%
  mutate(Tasa = as.numeric(Tasa))

top5_mas_abortos <- datos_long %>% 
    filter(Year == 2024) %>%
    slice_max(Tasa, n = 5) %>% 
  arrange(desc(Tasa))
gt(top5_mas_abortos)
```
Estas Comunidades suelen contar con una **red s√≥lida de cl√≠nicas privadas** concertadas (donde se realiza la gran mayor√≠a de las IVE en Espa√±a) y una menor tasa de objeci√≥n de conciencia en el sector p√∫blico o privado, garantizando una **mayor accesibilidad**.**Las 5 CCAA con *menores Tasas* de Aborto**


**Las 5 CC.AA con menores Tasas de Aborto**

Las tasas m√°s bajas se encuentran consistentemente en las Ciudades Aut√≥nomas de **Melilla** y **Ceuta**, ambas con 4.65 abortos por cada 1000 mujeres. Estos valores representan aproximadamente **la tercera parte** de las tasas m√°s altas del pa√≠s (como Catalu√±a, con 14.89).


```{r}
top5_menos_abortos <- datos_long %>% 
  filter(Year == 2024) %>%
  slice_min(Tasa, n = 5) %>% 
  arrange(desc(Tasa))
gt(top5_menos_abortos)




datos_long <- datos_long %>%
  rename(Comunidad = `Comunidad Aut√≥noma`)


crecimiento_abortos <- datos_long %>%
  filter(Comunidad  != "Total") %>%
  group_by(Comunidad ) %>% 
mutate(
crecimiento_anual = Tasa - lag(Tasa)) %>%
  summarise(
    Tasa_Inicial_2015 = first(Tasa), 
    Tasa_Final_2024 = last(Tasa),  
    Crecimiento_Total = Tasa_Final_2024 - Tasa_Inicial_2015,
    .groups = 'drop' 
  ) %>%
  slice_max(Crecimiento_Total, n = 10) %>%
  arrange(desc(Crecimiento_Total))

gt(crecimiento_abortos)
```

En Comunidades como **Castilla y Le√≥n, Murcia, Extremadura, La Rioja, Ceuta y Melilla**, la alta tasa de objeci√≥n de conciencia por parte del personal m√©dico (especialmente ginec√≥logos y anestesistas) en la sanidad p√∫blica **impide la realizaci√≥n de la IVE** entre otros factores culturales.

**Tasas de crecimiento IVE desde 2014 hasta 2024**

Esta tabla resume la **variaci√≥n absoluta** experimentada en la tasa de Interrupci√≥n Voluntaria del Embarazo (IVE) por cada 1.000 mujeres entre el inicio del periodo (2015) y el final (2024).

El indicador clave es el **Crecimiento Total**, que se calcula como la diferencia entre la Tasa Final (2024) y la Tasa Inicial (2015). La tabla presenta las 10 Comunidades Aut√≥nomas donde este crecimiento fue m√°s pronunciado.


## Coropleta abortos en Espa√±a en 2024

Este mapa coropleta representa la **distribuci√≥n geogr√°fica de la Tasa de Interrupci√≥n Voluntaria del Embarazo (IVE)** por cada **1.000 mujeres en edad f√©rtil (15-44 a√±os)** en las Comunidades Aut√≥nomas (CC.AA.) y Ciudades Aut√≥nomas de Espa√±a durante el a√±o 2024.

El mapa utiliza una escala de color para categorizar la incidencia del aborto, facilitando la identificaci√≥n de patrones regionales:
```{r}
#| echo: true
#| message: false
#| warning: false
mapa_ccaa <- gisco_get_nuts(
  country = "ES",         
  nuts_level = "2",       
  resolution = "3"
)

datos_2024_completo <- datos_long %>% 
  filter(Year == 2024, Comunidad != "Total") %>%
  mutate(
    CCAA_Limpia = case_when(
      Comunidad == "Asturias, Principado de" ~ "Principado de Asturias",
      Comunidad == "Baleares, Illes" ~ "Illes Balears",
      Comunidad == "C. Valenciana" ~ "Comunidad Valenciana",
      Comunidad == "Madrid, Comunidad de" ~ "Comunidad de Madrid",
      Comunidad == "Murcia, Regi√≥n de" ~ "Regi√≥n de Murcia",
      Comunidad == "Navarra, Comunidad Foral de" ~ "Comunidad Foral de Navarra",
      Comunidad == "Castilla - La Mancha" ~ "Castilla-La Mancha", 
      Comunidad == "Ceuta y Melilla, Ciudades Aut√≥nomas" ~ "Ciudad Aut√≥noma de Ceuta",
      TRUE ~ Comunidad
    ),
    Tasa = trimws(Tasa),
    Tasa = str_replace(Tasa, ",", "."),
    Tasa = as.numeric(Tasa))

datos_2024_completo <- bind_rows(
  datos_2024_completo,
  datos_2024_completo %>%
    filter(CCAA_Limpia == "Ciudad Aut√≥noma de Ceuta") %>%
    mutate(CCAA_Limpia = "Ciudad Aut√≥noma de Melilla"))

datos_2024_completo <- datos_2024_completo %>%
  mutate(Categoria = cut(
    Tasa,
    breaks = c(-Inf, 9.0, 13.0, Inf),
    labels = c("Baja (Gris)", "Media (Violeta Claro)", "Alta (Violeta)"),
    right = FALSE))

mapa_final <- mapa_ccaa %>% 
  mutate(
    CCAA_Limpia = case_when(
      NAME_LATN %in% c("Ceuta", "Melilla") ~ "Ceuta y Melilla",
      TRUE ~ NAME_LATN
    )
  ) %>%
  left_join(datos_2024_completo, by = "CCAA_Limpia")

paleta_colores <- c(
  "Baja (Gris)" = "lightgrey", 
  "Media (Violeta Claro)" = "#E6E6FA", 
  "Alta (Violeta)" = "plum"
)


mapa_coropleta <- ggplot(mapa_final) +
  geom_sf(
    aes(fill = Categoria),
    color = "grey60", 
    linewidth = 0.2
  ) +
  scale_fill_manual(
    values = paleta_colores,
    name = "Tasa de Abortos (por 1.000) - 2024"
  ) +
  geom_sf_text(
    aes(label = CCAA_Limpia),
    size = 2,
    fontface = "bold",
    check_overlap = TRUE
  ) +
  labs(
    title = "Tasa de Abortos por CCAA (2024)",
    caption = "Clasificaci√≥n: Baja < 9.0, Media < 13.0, Alta ‚â• 13.0",
    fill = "Categor√≠a de Tasa"
  ) +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    legend.position = "left",
    legend.title = element_text(face = "bold.italic"),  
    legend.text = element_text(size = 12),
    plot.title = element_text(hjust = 0.5, face = "bold.italic", size = 16))

mapa_coropleta

```

La distribuci√≥n de las tasas de aborto en Espa√±a no es un reflejo puro de la demanda de la poblaci√≥n femenina, sino un indicador de la **eficacia de las pol√≠ticas de gesti√≥n y la influencia de la objeci√≥n de conciencia** en el sistema sanitario de cada Comunidad.

Las tasas m√≠nimas suelen indicar **barreras de acceso**, y las tasas m√°ximas suelen indicar **servicios de referencia** que absorben la demanda de otras zonas.

## Abortos precovid y postcovid 
Esta tabla resume la **m√°xima y m√≠nima tasa de interrupci√≥n voluntaria del embarazo (IVE)** por cada 1.000 mujeres en edad f√©rtil (15-44 a√±os) en Espa√±a, agrupando los datos en tres bloques temporales:

**-Pre-COVID:** A√±os anteriores a la pandemia (hasta 2019).

**--COVID:** A√±os directamente afectados por las restricciones (2020-2021).

**---Post-COVID:** A√±os de recuperaci√≥n y nueva normalidad (a partir de 2022).

Aunque la pandemia pudo afectar la movilidad y el acceso a los servicios (principalmente en 2020 y 2021), la tabla sugiere que el COVID-19 **no alter√≥ fundamentalmente el patr√≥n regional de alta y baja incidencia** de abortos en Espa√±a. Las Comunidades que ya ten√≠an las tasas m√°s altas (como Catalu√±a) y las m√°s bajas (como Ceuta o Melilla) mantuvieron sus posiciones relativas.

```{r}
#| echo: true
#| message: false
#| warning: false

datos_long <- datos_long %>%
  mutate(
    Bloque = case_when(
      Year <= 2019 ~ "Pre-COVID",
      Year %in% 2020:2021 ~ "COVID",
      Year >= 2022 ~ "Post-COVID"))

comparacion <- datos_long %>%
  group_by(Bloque) %>%
  summarise(
    Mayor_Tasa_CCAA = Comunidad[which.max(Tasa)],
    Mayor_Tasa = max(Tasa),
    Menor_Tasa_CCAA = Comunidad[which.min(Tasa)],
    Menor_Tasa = min(Tasa)
  ) %>%
  ungroup()

tabla_gt2 <- comparacion %>%
  gt() %>%
  tab_header(
    title = "CCAA con la Mayor y Menor Tasa de Abortos por Bloques de A√±os: Pre-COVID, COVID y Post-COVID" ) %>%
  cols_label(
    Bloque = "",
    Mayor_Tasa_CCAA = "CCAA Mayor Tasa",
    Mayor_Tasa = "Mayor Tasa",
    Menor_Tasa_CCAA = "CCAA Menor Tasa",
    Menor_Tasa = "Menor Tasa") %>%
  tab_source_note(
    source_note = "Las tasas est√°n expresadas por 1.000 habitantes de cada CCAA.")  %>%
  tab_style(
  style = cell_text(size = px(10)),
  locations = cells_source_notes()
)



tabla_gt2%>% gtExtras::gt_theme_pff()

 

```

# Leyes que regulan el aborto en el mundo 

## condiciones por aborto y despues de aborto

En este gr√°fico vemos las principlaes bases legales por las cuales el aborto est√† permitido, y nos muestra que **la mayor√≠a de los pa√≠ses autorizan el aborto cuando existe riesgo para la vida de la mujer**, lo que refleja un amplio consenso internacional sobre esta condici√≥n. **La autorizaci√≥n disminuye** en los **casos relacionados con la salud f√≠sica y es a√∫n m√°s limitada cuando se trata de malformaciones fetales o de embarazos derivados de violaci√≥n o incesto**. Este patr√≥n evidencia importantes diferencias legales y culturales entre los pa√≠ses y muestra que, fuera de las situaciones de riesgo vital, el **acceso al aborto sigue siendo restrictivo** en muchas partes del mundo.
```{r}
#| echo: true
#| message: false
#| warning: false
united_nations_ruta <-"./datasets/united_nations.csv"
df_unitednat <- rio::import(united_nations_ruta)

df_unitednat <- df_unitednat %>%
  select(V2, V3, V4, V5, V6, V7, V8, V9, V10, V11, V12, V13)

colnames(df_unitednat) <- c(
  "country",
  "country code",
  "life_risk",
  "physical_health",
  "rape_incest",
  "fetal_impairment",
  "medical_authorization",
  "judicial_consent_minors",
  "husband_consent",
  "criminal_charge",
  "post_abortion_law",
  "contradictory_legal_systems"
)

df_basi_legali_noNA <- df_unitednat %>%
  select(country, life_risk, physical_health, rape_incest, fetal_impairment) %>%
  mutate(
    across(
      c(life_risk, physical_health, rape_incest, fetal_impairment),
      ~ case_when(
        . == "Yes" ~ 1,
        . == "No"  ~ 0,
        TRUE ~ NA_real_))) %>%
  drop_na(life_risk, physical_health, rape_incest, fetal_impairment)

aa <- df_basi_legali_noNA %>%
  summarise(
    across(
      c(life_risk, physical_health, rape_incest, fetal_impairment),
      ~ sum(., na.rm = TRUE))
    )

paises_si <- df_basi_legali_noNA %>%
  filter(
    life_risk == 1,
    physical_health == 1,
    rape_incest == 1,
    fetal_impairment == 1
  )



baseleg_long <- df_unitednat %>%
  select(country, life_risk, physical_health, rape_incest, fetal_impairment) %>%
  pivot_longer(
    cols      =  -country,
    names_to  = "si_por_variable",
    values_to = "value") %>%
  filter(value ==  "Yes") %>%       
  count(si_por_variable, name = "n_yes")




p2 <- ggplot(baseleg_long, aes(x = si_por_variable, y = n_yes)) +
  geom_col(fill = "#2A9D8F") +  
  coord_flip() +
  labs(
    title = "Pa√≠ses que autorizan el aborto en todas las bases legales",
    x = "Variable",
    y = "N√∫mero de pa√≠ses"
  ) +
  theme_minimal()

ggplotly(p2, width = 600, height = 400)

```

## Restricciones adicionales cuando el aborto es legal

El gr√°fico muestra que, **incluso cuando el aborto es legal**, muchos pa√≠ses imponen restricciones adicionales de tipo procedimental. La m√°s frecuente es la autorizaci√≥n m√©dica, presente en un elevado n√∫mero de pa√≠ses, lo que limita la autonom√≠a de la mujer en la toma de decisiones. En menor medida, algunos pa√≠ses exigen consentimiento judicial para las menores o incluso el consentimiento del marido, **restricciones que evidencian la persistencia de barreras legales** e institucionales al acceso efectivo al aborto.

```{r}
#| echo: true
#| message: false
#| warning: false
df_restriccion <- df_unitednat %>%
  select(country, medical_authorization, judicial_consent_minors, husband_consent) %>%
  mutate(
    across(
      c(medical_authorization, judicial_consent_minors, husband_consent),
      ~ case_when(
        . == "Yes" ~ 1,
        . == "No"  ~ 0,
        TRUE ~ NA_real_))) %>%
  drop_na(medical_authorization, judicial_consent_minors, husband_consent)

restrictions_long <- df_unitednat %>%
  select(country, medical_authorization, judicial_consent_minors, husband_consent) %>%
  pivot_longer(
    cols      = -country,
    names_to  = "restriction",
    values_to = "value"
  ) %>%
  filter(value == "Yes") %>%
  count(restriction, name = "n_yes")


k3 <- ggplot(restrictions_long, aes(x = restriction, y = n_yes)) +
  geom_col(fill = "#E63946") +
  coord_flip() +
  labs(
    title = "Pa√≠ses con restricciones procesales al aborto",
    x = "Tipo de restricci√≥n",
    y = "N√∫mero de pa√≠ses"
  )
ggplotly(k3, width = 600, height = 400)

```

## Pa√≠ses donde el aborto est√° penalizado

¬øEn cu√°ntos pa√≠ses est√° penalizado el aborto? ¬øCu√°ntos pa√≠ses cuentan con leyes sobre atenci√≥n postaborto? ¬øY c√≥mo se relaciona esta informaci√≥n con las bases legales?

```{r}
df_crimen <- df_unitednat%>%
  select(country, life_risk, physical_health, rape_incest, fetal_impairment,
         criminal_charge, post_abortion_law, contradictory_legal_systems)


crimen_summary <- df_crimen %>%
  summarise(
    criminalized_yes      = sum(criminal_charge == "Yes", na.rm = TRUE),
    criminalized_no       = sum(criminal_charge == "No",  na.rm = TRUE),
    post_abortion_yes     = sum(post_abortion_law == "Yes", na.rm = TRUE),
    post_abortion_no      = sum(post_abortion_law == "No",  na.rm = TRUE),
    contradictions_yes    = sum(contradictory_legal_systems == "Yes", na.rm = TRUE),
    contradictions_no     = sum(contradictory_legal_systems == "No",  na.rm = TRUE)
  )


crimen_long <- tibble(
  categoria = c("criminal_charge", "criminal_charge",
                "post_abortion_law", "post_abortion_law",
                "contradictory_legal_systems", "contradictory_legal_systems"),
  value     = c("Yes", "No", "Yes", "No", "Yes", "No"),
  n         = c(crimen_summary$criminalized_yes,
                crimen_summary$criminalized_no,
                crimen_summary$post_abortion_yes,
                crimen_summary$post_abortion_no,
                crimen_summary$contradictions_yes,
                crimen_summary$contradictions_no)
)

p3 <- ggplot(crimen_long, aes(x = categoria, y = n, fill = value)) +
  geom_col(position = "dodge") +
  coord_flip() +
  labs(
    title = "Criminalizaci√≥n del aborto y leyes post-aborto",
    x = "Categor√≠a",
    y = "N√∫mero de pa√≠ses",
    fill = "Valor"
  ) +
  theme_minimal()

ggplotly(p3, width = 600, height = 400)



```
